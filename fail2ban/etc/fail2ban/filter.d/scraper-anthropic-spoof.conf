[Definition]
# Matches typical Apache/Nginx "combined" access logs
# Example: 203.0.113.5 - - [..] "GET / HTTP/1.1" 200 123 "-" "Anthropic/1.0"
# Capture client IP as <HOST> and ensure UA contains "Anthropic" (case-insensitive).
#failregex = ^<HOST>\s+\S+\s+\S+\s+\[[^\]]+\]\s+"(?:GET|POST|HEAD|PUT|DELETE|OPTIONS|PATCH)\s+[^"]+"\s+\d{3}\s+\d+\s+"[^"]*"\s+"(?i:.*anthropic.*)"\s*$
#failregex = ^<HOST>\s+\S+\s+\S+\s+\[[^\]]+\]\s+"(?:GET|POST|HEAD|PUT|DELETE|OPTIONS|PATCH)\s+[^"]+"\s+\d{3}\s+[0-9-]+\s+"[^"]*"\s+"[^"]*[Aa]nthropic[^"]*"\s*$
failregex = ^<HOST> .* "[A-Z]+ [^"]+" \d{3} [0-9-]+ "[^"]*" "[^"]*[Aa]nthropic[^"]*"\s*$
ignoreregex =
maxlines = 1
